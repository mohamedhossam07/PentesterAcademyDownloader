import re
import requests
import progressbar
import math
import time

courseLink = input("Enter Course Link : ")
courseCookie = input("Enter SACSID : ")
coursePath = input("Enter Saving Path ends with \ : ")
response = requests.get(courseLink)
courseList = re.findall('\/video\?id=\d*', response.text)
cookies = {'SACSID': courseCookie}
videoNumber = 1
for itrVideo in courseList:
    videoId = int(re.findall('\d.*', itrVideo)[0])
    print ("[+] Downloading https://www.pentesteracademy.com/accounting?id="+str(videoId))
    print (itrVideo)
    r = requests.get("https://www.pentesteracademy.com/accounting?id="+str(videoId), cookies=cookies, stream=True)
    r.raise_for_status()
    n_chunk = 1
    block_size = 1024
    file_size = int(r.headers.get('Content-Length', None))
    num_bars = math.ceil(file_size / (n_chunk * block_size))
    bar =  progressbar.ProgressBar(maxval=num_bars).start()
    with open( coursePath +"Video" + str(videoNumber) + ".mp4", "wb") as f:
            for i, chunk in enumerate(r.iter_content(chunk_size=n_chunk * block_size)):
                f.write(chunk)
                bar.update(i+1)
                time.sleep(0.05)
    videoNumber = videoNumber + 1